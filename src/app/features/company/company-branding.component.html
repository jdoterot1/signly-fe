<div class="min-h-full bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-5xl mx-auto space-y-8">
    <section class="bg-white rounded-3xl shadow px-6 py-8">
      <div class="flex flex-col gap-3 md:flex-row md:items-start md:justify-between">
        <div>
          <h2 class="text-xl font-semibold text-gray-900">Identidad visual</h2>
          <p class="text-sm text-gray-500">Colores, logos y remitentes usados en correos.</p>
        </div>
      </div>

      <div *ngIf="isLoadingBranding" class="mt-6 text-sm text-gray-500 animate-pulse">
        Trayendo los colores y logos configurados...
      </div>

      <form
        *ngIf="!isLoadingBranding"
        class="mt-6 space-y-6"
        [formGroup]="brandingForm"
        (ngSubmit)="onSaveBranding()"
      >
        <div class="grid gap-5 md:grid-cols-2">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Color primario</label>
            <div class="flex items-center gap-3">
              <input
                type="color"
                formControlName="primary_color"
                class="h-12 w-16 rounded-xl border border-gray-200"
              />
              <span class="font-mono text-sm text-gray-600">{{ brandingForm.get('primary_color')?.value }}</span>
            </div>
            <p class="mt-1 text-xs text-red-500" *ngIf="brandingForm.get('primary_color')?.invalid && brandingForm.get('primary_color')?.touched">
              Usa un color HEX válido.
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Color secundario</label>
            <div class="flex items-center gap-3">
              <input
                type="color"
                formControlName="secondary_color"
                class="h-12 w-16 rounded-xl border border-gray-200"
              />
              <span class="font-mono text-sm text-gray-600">{{ brandingForm.get('secondary_color')?.value }}</span>
            </div>
            <p class="mt-1 text-xs text-red-500" *ngIf="brandingForm.get('secondary_color')?.invalid && brandingForm.get('secondary_color')?.touched">
              Usa un color HEX válido.
            </p>
          </div>
        </div>

        <div class="grid gap-5 md:grid-cols-2">
          <div>
            <label class="block text-sm font-medium text-gray-700">Logo (URL)</label>
            <input
              type="url"
              formControlName="logo_url"
              class="mt-1 w-full rounded-xl border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#3366FF]"
              placeholder="https://cdn.signly.app/logo.svg"
            />
            <p class="mt-1 text-xs text-red-500" *ngIf="brandingForm.get('logo_url')?.invalid && brandingForm.get('logo_url')?.touched">
              Agrega una URL válida para el logo.
            </p>
            <img
              *ngIf="brandingForm.value.logo_url"
              [src]="brandingForm.value.logo_url"
              alt="Logo preview"
              class="mt-4 max-h-16 object-contain"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Favicon (URL)</label>
            <input
              type="url"
              formControlName="favicon_url"
              class="mt-1 w-full rounded-xl border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#3366FF]"
              placeholder="https://cdn.signly.app/favicon.ico"
            />
            <p class="mt-1 text-xs text-red-500" *ngIf="brandingForm.get('favicon_url')?.invalid && brandingForm.get('favicon_url')?.touched">
              Agrega una URL válida para el favicon.
            </p>
            <img
              *ngIf="brandingForm.value.favicon_url"
              [src]="brandingForm.value.favicon_url"
              alt="Favicon preview"
              class="mt-4 h-12 w-12 rounded"
            />
          </div>
        </div>

        <div class="grid gap-5 md:grid-cols-2">
          <div>
            <label class="block text-sm font-medium text-gray-700">Nombre remitente (emails)</label>
            <input
              type="text"
              formControlName="email_sender_name"
              class="mt-1 w-full rounded-xl border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#3366FF]"
              placeholder="Apolo Systems"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Correo remitente</label>
            <input
              type="email"
              formControlName="email_sender_addr"
              class="mt-1 w-full rounded-xl border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#3366FF]"
              placeholder="noreply@apolosystems.co"
            />
            <p class="mt-1 text-xs text-red-500" *ngIf="brandingForm.get('email_sender_addr')?.invalid && brandingForm.get('email_sender_addr')?.touched">
              Ingresa un correo válido.
            </p>
          </div>
        </div>

        <div class="flex flex-col gap-3 sm:flex-row sm:justify-end">
          <button
            type="button"
            class="px-4 py-2 rounded-xl border text-sm text-gray-600 hover:bg-gray-50"
            (click)="loadBranding()"
            [disabled]="isSavingBranding"
          >
            Descartar cambios
          </button>
          <button
            type="submit"
            class="px-5 py-2 rounded-xl bg-[#3366FF] text-white font-semibold hover:bg-[#274FCC] disabled:opacity-60"
            [disabled]="isSavingBranding"
          >
            {{ isSavingBranding ? 'Guardando...' : 'Actualizar branding' }}
          </button>
        </div>
      </form>
    </section>
  </div>
</div>
