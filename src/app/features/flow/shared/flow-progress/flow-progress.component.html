<header class="sticky md:relative top-0 z-30 px-3 md:px-6 pt-3 md:pt-5 pb-2 md:pb-0 bg-slate-50/90 md:bg-transparent backdrop-blur-sm">
  <div class="mx-auto max-w-5xl rounded-2xl border border-white/70 bg-white/80 backdrop-blur-xl shadow-xl shadow-slate-200/60 p-3 md:p-5">
    <div class="flex items-start justify-between gap-3 md:gap-5">
      <div class="min-w-0">
        <div class="flex items-center gap-3">
          <img src="assets/icons/sidebar/ApoloLogo.svg" alt="Signly" class="h-8 w-8" />
          <div class="min-w-0">
            <p class="text-[10px] md:text-xs uppercase tracking-[0.24em] text-slate-500 font-semibold">Firma Digital</p>
            <p class="text-sm md:text-base font-semibold text-slate-900 truncate">Proceso enviado por {{ companyName }}</p>
          </div>
        </div>
        <p class="mt-1 text-[11px] md:text-xs text-slate-500 break-all hidden md:block" *ngIf="processId">
          ID: {{ processId }}
        </p>
      </div>

      <button
        type="button"
        class="inline-flex items-center gap-1.5 md:gap-2 rounded-full border border-slate-200 bg-white px-2.5 md:px-4 py-1.5 md:py-2 text-[10px] md:text-xs font-semibold text-slate-700 hover:bg-slate-50 transition shrink-0"
        (click)="helpOpen = true"
      >
        <i class="pi pi-question-circle"></i>
        Ayuda
      </button>
    </div>

    <div class="mt-4 md:mt-5">
      <div class="hidden md:block relative">
        <div class="absolute left-8 right-8 top-4 h-[2px] bg-slate-200"></div>
        <ol class="relative grid grid-cols-5 gap-2">
          <li *ngFor="let step of steps; let i = index" class="text-center">
            <div
              class="mx-auto h-8 w-8 rounded-full border-2 flex items-center justify-center text-[11px] font-semibold bg-white"
              [ngClass]="{
                'border-blue-600 text-blue-600': isActive(step.key),
                'border-emerald-500 bg-emerald-500 text-white': isCompleted(step.key),
                'border-slate-300 text-slate-400': !isActive(step.key) && !isCompleted(step.key)
              }"
            >
              <i class="pi pi-check text-[10px]" *ngIf="isCompleted(step.key)"></i>
              <span *ngIf="!isCompleted(step.key)">{{ i + 1 }}</span>
            </div>
            <p class="mt-2 text-[11px] font-semibold"
               [ngClass]="{
                'text-blue-700': isActive(step.key),
                'text-emerald-700': isCompleted(step.key),
                'text-slate-400': !isActive(step.key) && !isCompleted(step.key)
               }">
              {{ step.label }}
            </p>
            <p class="text-[10px] text-slate-400">{{ step.caption }}</p>
          </li>
        </ol>
      </div>

      <div class="md:hidden">
        <ol class="grid grid-cols-5 gap-1.5">
          <li *ngFor="let step of steps; let i = index" class="text-center min-w-0">
            <div
              class="mx-auto h-6 w-6 rounded-full border-2 flex items-center justify-center text-[9px] font-semibold bg-white"
              [ngClass]="{
                'border-blue-600 text-blue-600': isActive(step.key),
                'border-emerald-500 bg-emerald-500 text-white': isCompleted(step.key),
                'border-slate-300 text-slate-400': !isActive(step.key) && !isCompleted(step.key)
              }"
            >
              <i class="pi pi-check text-[8px]" *ngIf="isCompleted(step.key)"></i>
              <span *ngIf="!isCompleted(step.key)">{{ i + 1 }}</span>
            </div>
            <p class="mt-1 text-[9px] font-semibold leading-tight truncate"
               [ngClass]="{
                'text-blue-700': isActive(step.key),
                'text-emerald-700': isCompleted(step.key),
                'text-slate-400': !isActive(step.key) && !isCompleted(step.key)
               }">
              {{ step.label }}
            </p>
          </li>
        </ol>
      </div>
    </div>
  </div>
</header>

<div *ngIf="helpOpen" class="fixed inset-0 z-50 flex items-end md:items-center justify-center bg-slate-900/45 p-3 md:p-6">
  <section class="w-full max-w-lg rounded-2xl border border-slate-100 bg-white shadow-2xl p-5 md:p-6">
    <div class="flex items-start justify-between gap-4">
      <div>
        <p class="text-[10px] uppercase tracking-[0.22em] text-slate-500 font-semibold">Centro de ayuda</p>
        <h3 class="mt-1 text-lg font-semibold text-slate-900">Como completar el flujo</h3>
      </div>
      <button
        type="button"
        class="h-8 w-8 rounded-full border border-slate-200 text-slate-500 hover:text-slate-700 hover:bg-slate-50"
        (click)="helpOpen = false"
        aria-label="Cerrar ayuda"
      >
        <i class="pi pi-times text-xs"></i>
      </button>
    </div>

    <div class="mt-4 space-y-2">
      <div *ngFor="let tip of helpChecklist; let i = index" class="rounded-xl border border-slate-100 bg-slate-50/70 px-3 py-2.5">
        <p class="text-xs md:text-sm text-slate-700"><span class="font-semibold text-slate-900">{{ i + 1 }}.</span> {{ tip }}</p>
      </div>
    </div>
  </section>
</div>
