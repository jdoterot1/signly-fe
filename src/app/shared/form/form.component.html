<!-- src/app/shared/form/form.component.html -->
<form [formGroup]="form" (ngSubmit)="onSubmit()"
      class="bg-white rounded shadow p-10 w-[1600px] mx-auto mt-2">
  <div class="flex">
    <!-- Columna izquierda: todos tus campos -->
    <div class="w-1/2 space-y-6">
      <ng-container *ngFor="let field of config.fields">
        <ng-container [ngSwitch]="field.type">

          <!-- Text -->
          <ng-container *ngSwitchCase="'text'">
            <div class="mb-4">
              <label [for]="field.key" class="block mb-1 font-medium">
                {{ field.label }}
                <span *ngIf="field.required" class="text-red-500">*</span>
              </label>
              <input
                pInputText
                [id]="field.key"
                [placeholder]="field.placeholder"
                [formControlName]="field.key"
                class="w-full"
              />
            </div>
          </ng-container>

          <!-- Email -->
          <ng-container *ngSwitchCase="'email'">
            <div class="mb-4">
              <label [for]="field.key" class="block mb-1 font-medium">
                {{ field.label }}
                <span *ngIf="field.required" class="text-red-500">*</span>
              </label>
              <input
                pInputText
                type="email"
                [id]="field.key"
                [placeholder]="field.placeholder"
                [formControlName]="field.key"
                class="w-full"
              />
            </div>
          </ng-container>

          <!-- Password -->
          <ng-container *ngSwitchCase="'password'">
            <div class="mb-4">
              <label [for]="field.key" class="block mb-1 font-medium">
                {{ field.label }}
                <span *ngIf="field.required" class="text-red-500">*</span>
              </label>
              <p-password
                [inputId]="field.key"
                [placeholder]="field.placeholder"
                [formControlName]="field.key"
                [toggleMask]="true"
                class="w-full"
              />
            </div>
          </ng-container>

          <!-- Select -->
          <ng-container *ngSwitchCase="'select'">
            <div class="mb-4">
              <label [for]="field.key" class="block mb-1 font-medium">
                {{ field.label }}
                <span *ngIf="field.required" class="text-red-500">*</span>
              </label>
              <p-select
                [inputId]="field.key"
                [options]="field.options"
                optionLabel="name"
                [placeholder]="field.placeholder"
                [formControlName]="field.key"
                class="w-full"
              />
            </div>
          </ng-container>

          <!-- Toggle -->
          <ng-container *ngSwitchCase="'toggle'">
            <div class="mb-4 flex items-center gap-3">
              <label class="font-medium">{{ field.label }}</label>
              <p-toggleButton
                [formControlName]="field.key"
                onLabel="Activo"
                offLabel="Inactivo"
                class="w-24"
              />
            </div>
          </ng-container>

          <!-- Date -->
          <ng-container *ngSwitchCase="'date'">
            <div class="mb-4">
              <label [for]="field.key" class="block mb-1 font-medium">
                {{ field.label }}
              </label>
              <p-datepicker
                [inputId]="field.key"
                [placeholder]="field.placeholder"
                [formControlName]="field.key"
                class="w-full"
              />
            </div>
          </ng-container>

          <!-- Textarea -->
          <ng-container *ngSwitchCase="'textarea'">
            <div class="mb-4">
              <label [for]="field.key" class="block mb-1 font-medium">
                {{ field.label }}
              </label>
              <textarea
                pTextarea
                rows="5"
                [id]="field.key"
                [placeholder]="field.placeholder"
                [formControlName]="field.key"
                class="w-full"
              ></textarea>
            </div>
          </ng-container>

          <!-- Group (recursivo) -->
          <ng-container *ngSwitchCase="'group'">
            <fieldset class="border p-4 mb-4">
              <legend class="font-semibold mb-2">{{ field.label }}</legend>
              <app-form
                [config]="{ fields: field.children! }"
                [form]="getGroup(field)"
                (submitForm)="submitForm.emit($event)"
                (cancelForm)="cancelForm.emit()"
              ></app-form>
            </fieldset>
          </ng-container>

        </ng-container>
      </ng-container>
    </div>

    <!-- Columna derecha: imagen sÃ³lo si showImageUpload=true -->
      <div class="w-1/2 h-full">
        <div *ngIf="showImageUpload"
            class="flex flex-col items-center justify-start h-full mt-10">
          <!-- img que se reemplaza -->
          <img
            [src]="imagePreview || 'assets/icons/forms/ProfileImage.svg'"
            alt="Imagen de perfil"
            class="mb-6 w-56 h-56 rounded-full object-cover"
          />

          <!-- input file oculto -->
          <input
            #fileInput
            type="file"
            accept="image/*"
            class="hidden"
            (change)="onFileChange($event)"
          />

          <!-- botones Subir y Quitar -->
          <div class="flex items-center gap-2 mt-4">
            <button
              type="button"
              class="bg-blue-600 text-white px-4 py-2 rounded"
              (click)="openFileDialog()">
              Subir Foto
            </button>
            <button
              *ngIf="imagePreview"
              type="button"
              class="bg-red-600 text-white px-4 py-2 rounded"
              (click)="removeImage()">
              Quitar Foto
            </button>
          </div>
        </div>
      </div>
    </div>

  <!-- Botones -->
  <div class="flex justify-end gap-4 pt-4">
    <button type="button"
            class="bg-gray-300 px-4 py-2 rounded"
            (click)="cancelForm.emit()">
      Cancelar
    </button>
    <button type="submit"
            class="bg-blue-600 text-white px-4 py-2 rounded">
      Guardar
    </button>
  </div>
</form>
